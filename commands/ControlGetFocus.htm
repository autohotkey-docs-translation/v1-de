<!DOCTYPE HTML>
<html>
<head>
<title>ControlGetFocus</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/ga.js" type="text/javascript"></script>
<script src="../static/content.js" type="text/javascript"></script>
</head>
<body>

<h1>ControlGetFocus</h1>

<p>Ermittelt, welches Steuerelement im Zielfenster den Eingabefokus hat.</p>

<pre class="Syntax">ControlGetFocus, AusgabeVar [, Fenstertitel, Fenstertext, Titelausnahme, Textausnahme]</pre>
<h3>Parameter</h3>
<dl>

  <dt>AusgabeVar</dt>
  <dd><p>Name der Variable, in der die Bezeichnung des Steuerelements gespeichert werden soll. Die Bezeichnung selbst besteht aus den Klassennamen des Steuerelements, gefolgt von einer laufenden Nummer innerhalb des übergeordneten Fensters, z. B. Button12.</p></dd>

  <dt>Fenstertitel</dt>
  <dd><p>Ein Fenstertitel oder sonstige Kriterien, die das Zielfenster ermitteln sollen. Siehe <a href="../misc/WinTitle.htm">Fenstertitel</a>.</p></dd>

  <dt>Fenstertext</dt>
  <dd><p>In diesem Parameter kann ein Teilstring angegeben werden, der in einem Textelement des Zielfensters vorkommt (abrufbar mit Windows Spy). Versteckte Textelemente werden auch erkannt, sofern <a href="DetectHiddenText.htm">DetectHiddenText</a> aktiv ist.</p></dd>

  <dt>Titelausnahme</dt>
  <dd><p>Ignoriert Fenster, deren Titel diesen Wert enthalten.</p></dd>

  <dt>Textausnahme</dt>
  <dd><p>Ignoriert Fenster, deren Textelemente diesen Wert enthalten.</p></dd>

</dl>

<h3>ErrorLevel</h3>
<p><span class="ver">[v1.1.04+]</span> Dieser Befehl ist in der Lage, bei Misserfolg eine Ausnahme auszulösen. Für mehr Informationen, siehe <a href="Catch.htm#RuntimeErrors">Laufzeitfehler</a>.</p>
<p><a href="../misc/ErrorLevel.htm">ErrorLevel</a> wird auf 0 gesetzt, wenn das Steuerelement mit dem Eingabefokus ermittelt werden konnte. Ansonsten (z. B. wenn das Fenster nicht existiert oder kein einziges Steuerelement den Eingabefokus hat) wird ErrorLevel auf 1 gesetzt.</p>
<h3>Bemerkungen</h3>
<p>Das Steuerelement, welches mit diesem Befehl ermittelt wird, ist auch das Steuerelement, welches die Tastatureingaben des Benutzers empfängt.</p>
<p>Das Fenster muss aktiv sein, damit ein Steuerelement fokussiert sein kann. Ist das Fenster nicht aktiv, wird <em>AusgabeVar</em> leer gemacht.</p>
<p>Während ControlGetFocus mehrmals schnell ausgeführt wird (d. h. alle 500 ms oder schneller), kann der Benutzer wahrscheinlich keinen Doppelklick durchführen. Um dieses Problem zu vermeiden, kann die Systemfunktion GetGUIThreadInfo() mit <a href="DllCall.htm">DllCall</a> aufgerufen werden. Zum Beispiel:</p>
<pre><em>; Dieses Script ermittelt die ahk_id (HWND) des fokussierten Steuerelements im aktiven Fenster.</em>
GuiThreadInfoSize = 48
VarSetCapacity(GuiThreadInfo, GuiThreadInfoSize)
<a href="NumPut.htm">NumPut</a>(GuiThreadInfoSize, GuiThreadInfo, 0)
if not DllCall("GetGUIThreadInfo", uint, 0, str, GuiThreadInfo)
{
    MsgBox GetGUIThreadInfo() hat einen Fehler entdeckt.
    return
}
FocusedHWND := <a href="NumGet.htm">NumGet</a>(GuiThreadInfo, 12)  <em>; Ermittelt das hwndFocus-Feld aus der Struktur.</em>
MsgBox % "Die ahk_id (HWND) des fokussierten Steuerelements ist " . FocusedHWND
<em>; Diese ID kann für alle Steuerelement-Befehle verwendet werden.  Zum Beispiel:
; ControlGetText, AusgabeVar,, ahk_id %FocusedHWND%</em></pre>
<p>Fenstertitel und -texte unterscheiden zwischen Groß- und Kleinschreibung. Solange <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a> deaktiviert ist, werden versteckte Fenster nicht wahrgenommen.</p>
<h3>Siehe auch</h3>
<p><a href="ControlFocus.htm">ControlFocus</a>, <a href="ControlMove.htm">ControlMove</a>, <a href="ControlClick.htm">ControlClick</a>, <a href="ControlGetText.htm">ControlGetText</a>, <a href="ControlSetText.htm">ControlSetText</a>, <a href="ControlSend.htm">ControlSend</a></p>
<h3>Beispiel</h3>
<pre class="NoIndent">ControlGetFocus, AusgabeVar, Unbenannt - Editor
if ErrorLevel
    MsgBox, Das Fenster existiert nicht oder hat keine Steuerelemente mit Eingabefokus.
else
    MsgBox, Steuerelement mit Eingabefokus = %AusgabeVar%</pre>

</body>
</html>
