<!DOCTYPE HTML>
<html>
<head>
<title>FileSelectFolder</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/ga.js" type="text/javascript"></script>
<script src="../static/content.js" type="text/javascript"></script>
</head>
<body>

<h1>FileSelectFolder</h1>

<p>Zeigt ein Standard-Dialogfenster an, mit dem der Benutzer einen Ordner auswählen kann.</p>

<pre class="Syntax">FileSelectFolder, AusgabeVar [, Startordner, Optionen, Anzeigetext]</pre>
<h3>Parameter</h3>
<dl>

  <dt>AusgabeVar</dt>
  <dd><p>Name der Variable, in der der ausgewählte Ordner gespeichert werden soll. Sie wird leer gemacht, wenn der Benutzer das Dialogfenster abgebrochen hat (weil er einen Ordner nicht auswählen möchte). Wählt der Benutzer ein Root-Verzeichnis aus (z. B. C:\), wird <em>AusgabeVar</em> mit einem umgekehrten Schrägstrich enden. Falls das unerwünscht ist, kann der Schrägstrich wie folgt entfernt werden:</p>
      <pre>FileSelectFolder, Ordner
Ordner := RegExReplace(Ordner, "\\$")  <em>; Entfernt den umgekehrten Schrägstrich am Ende, falls vorhanden.</em></pre></dd>

  <dt>Startordner</dt>
  <dd><p>Fehlt dieser Parameter oder ist er leer, wird die Startauswahl im Benutzerordner "Eigene Dokumente" (oder auch im Arbeitsplatz/Computer) beginnen. Ein <a href="../misc/CLSID-List.htm">CLSID</a>-Ordner wie <code>::{20d04fe0-3aea-1069-a2d8-08002b30309d}</code> (Arbeitsplatz/Computer) kann angegeben werden, um die Navigation bei einem bestimmten Ordner zu beginnen.</p>
      <p>Ansonsten kann in diesem Parameter ein Sternchen angegeben werden, unmittelbar gefolgt vom absoluten Pfad des Laufwerks oder Ordners, das zu Beginn ausgewählt sein soll. Zum Beispiel würde <code>*C:\</code> das C-Laufwerk zu Beginn auwählen. Ebenso würde <code>*C:\Mein Ordner</code> diesen bestimmten Ordner zu Beginn auswählen.</p>
      <p>Das Sternchen kennzeichnet, dass der Benutzer vom Startordner bis zum Hauptverzeichnis navigieren darf. Ohne Sternchen darf der Benutzer nur einen Ordner innerhalb von <em>Startordner</em> (oder den <em>Startordner</em> selbst) auswählen. Ein Vorteil vom Weglassen des Sternchens ist es, dass der Verzeichnisbaum von <em>Startordner</em> zu Beginn aufgeklappt ist, so dass der Benutzer das Pluszeichen nicht erst anklicken muss.</p>
      <p>Ist das Sternchen vorhanden, kann bei Bedarf die Aufwärtsnavigation auf einen Ordner (außer Desktop) beschränkt werden. Dazu muss vor dem Sternchen der absolute Pfad des höchsten Ordners und ein nachfolgendes Leer- oder Tabulatorzeichen angegeben werden. Das folgenden Beispiel zeigt, wie der Benutzer daran gehindert werden kann, auf die darüberliegende Ebene von C:\Mein Ordner zu navigieren (das Startverzeichnis selbst ist aber C:\Mein Ordner\Projekte):<br>
      <code>C:\Mein Ordner *C:\Mein Ordner\Projekte</code></p>
    </dd>

  <dt>Optionen</dt>
  <dd><p>Eine der folgenden Zahlen:</p>
      <p><strong>0</strong>: Alle unteren Optionen sind deaktiviert (außer in Windows 2000, wo trotzdem der Button "Neuer Ordner" angezeigt wird).</p>
      <p><strong>1</strong> (Standard): Es wird ein Button zur Verfügung gestellt, den der Benutzer verwenden kann, um neue Ordner zu erstellen.</p>
      <p><strong>Addiere 2</strong> mit der oberen Zahl, um ein Eingabefeld bereitzustellen, das der Benutzer für die Eingabe eines Ordnernamens verwenden kann. Hat dieser Parameter beispielsweise eine Wert von 3, würde sowohl ein Eingabefeld als auch der Button "Neuer Ordner" hinzugefügt.</p>
      <p><strong><a name="NewDialog"></a>Addiere 4</strong> mit der oberen Zahl, um die BIF_NEWDIALOGSTYLE-Eigenschaft zu entfernen. Die Addition mit 4 stellt sicher, dass FileSelectFolder auch in einer Vorinstallationsumgebung wie WinPE oder BartPE funktioniert. Allerdings wird dadurch verhindert, dass der Button "Neuer Ordner" angezeigt wird, zumindest unter Windows XP. ["4" benötigt v1.0.48+]</p>
      <p>Schreibt der Benutzer einen ungültigen Ordnernamen ins Eingabefeld, wird <em>AusgabeVar</em> den Ordner enthalten, der im Navigationsbereich ausgewählt wurde, anstatt das, was der Benutzer eingegeben hat, zumindest unter Windows XP.</p>
      <p>Dieser Parameter kann ein <a href="../Variables.htm#Expressions">Ausdruck</a> sein.<br>
      </p></dd>

  <dt>Anzeigetext</dt>
  <dd><p>Text, der im Fenster angezeigt werden soll, um den Benutzer zu sagen, was er tun soll. Fehlt dieser Parameter oder ist er leer, wird standardmäßig "Select Folder - %A_SCRIPTNAME%" (der Name des aktuellen Scripts) gelten.</p></dd>

</dl>

<h3>ErrorLevel</h3>
<p><span class="ver">[v1.1.04+]</span> Dieser Befehl ist in der Lage, bei Misserfolg eine Ausnahme auszulösen. Für mehr Informationen, siehe <a href="Catch.htm#RuntimeErrors">Laufzeitfehler</a>.</p>
<p><a href="../misc/ErrorLevel.htm">ErrorLevel</a> wird auf 1 gesetzt, wenn der Benutzer das Dialogfenster geschlossen hat, ohne einen Ordner ausgewählt zu haben (z. B. durch Drücken des Buttons "Abbrechen"), oder wenn das Betriebssystem sich weigert, das Dialogfenster anzuzeigen (selten). Ansonsten wird es auf 0 gesetzt.</p>
<h3>Bemerkungen</h3>
<p>Ein GUI-Fenster kann per <a href="Gui.htm#OwnDialogs">Gui, +OwnDialogs</a> ein modales Ordnerauswahlfenster anzeigen. Ein modales Dialogfenster hindert den Benutzer daran, mit dem GUI-Fenster zu interagieren, bis das Dialogfenster wieder geschlossen wird.</p>
<p>Bekannte Einschränkung: Ein <a href="SetTimer.htm">Timer</a>, den man während eines Ordnerauswahlfensters startet, wird die Mausklicks des Benutzers innerhalb des Dialogfensters hinauszögern, bis der Timer endet. Um dies zu umgehen, solltest du keine Timer verwenden, deren Subroutinen eine lange Zeit zum Beenden brauchen, oder alle Timer während des Dialogfensters deaktivieren:</p>
<pre><a href="Thread.htm">Thread</a>, NoTimers
FileSelectFolder, AusgabeVar,, 3
Thread, NoTimers, false</pre>
<h3>Siehe auch</h3>
<p><a href="FileSelectFile.htm">FileSelectFile</a>, <a href="MsgBox.htm">MsgBox</a>, <a href="InputBox.htm">InputBox</a>, <a href="ToolTip.htm">ToolTip</a>, <a href="Gui.htm">GUI</a>, <a href="../misc/CLSID-List.htm">CLSID-Liste</a>, <a href="FileCopyDir.htm">FileCopyDir</a>, <a href="FileMoveDir.htm">FileMoveDir</a>, <a href="SplitPath.htm">SplitPath</a></p>
<p>Das Betriebssystem bietet zudem Standard-Dialogfenster, die den Benutzer auffordern können, eine Farbe, eine Schriftart oder ein Icon auszuwählen. Diese Dialogfenster können per <a href="DllCall.htm">DllCall()</a> angezeigt werden, siehe dazu <a href="http://www.autohotkey.com/forum/topic17230.html">www.autohotkey.com/forum/topic17230.html</a>.</p>
<h3>Beispiel</h3>
<pre class="NoIndent">FileSelectFolder, AusgabeVar, , 3
if AusgabeVar =
    MsgBox, Keinen Ordner ausgewählt.
else
    MsgBox, Ordner "%AusgabeVar%" ausgewählt.

<em>; <a href="../misc/CLSID-List.htm">CLSID</a>-Beispiel:</em>
FileSelectFolder, AusgabeVar, ::{20d04fe0-3aea-1069-a2d8-08002b30309d}  <em>; Arbeitsplatz/Computer</em></pre>

</body>
</html>
