<!DOCTYPE HTML>
<html>
<head>
<title>ControlGetPos</title>
<meta name="keywords" content="Befehl, Steuerelement">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<link href="../static/font.css" rel="stylesheet" type="text/css" />
<script src="../static/ga.js" type="text/javascript"></script>
<!--[if lt IE 9]>
<script src="../static/html5.js"></script>
<![endif]-->
<script src="../navbar/NavScript.js" type="text/javascript"></script>
</head>
<body>
<script type="text/javascript">WriteHeader(1);</script>
<div id="content">
  <section>
    <article>
    <h1>ControlGetPos</h1>
    <p>Ermittelt die Position und Größe eines Steuerelements.</p>
    <pre class="Syntax">ControlGetPos [, X, Y, Breite, Höhe, Steuerelement, Fenstertitel, Fenstertext, Titelausnahme, Textausnahme] </pre>
    <h3>Parameter</h3>
    <table class="info">
      <tr>
        <td>X, Y</td>
        <td><p>Namen der Variablen, in denen die Koordinaten X und Y der oberen linken Ecke des <em>Steuerelements</em> gespeichert werden sollen (in Pixel). Diese Koordinaten beziehen sich auf die linke obere Ecke des Fensters und sind daher dieselben, die im Befehl <a href="ControlMove.htm">ControlMove</a> benutzt werden.</p>
          <p>Sobald ein Parameter weggelassen wird, wird dessen Wert entsprechend nicht gespeichert.</p></td>
      </tr>
      <tr>
        <td style="width: 15%;">Breite/Höhe</td>
        <td style="width: 85%;">Namen der Variablen, in denen die Breite und Höhe des <em>Steuerelements</em> gespeichert werden sollen (in Pixel). Sobald ein Parameter weggelassen wird, wird dessen Wert entsprechend nicht gespeichert.</td>
      </tr>
      <tr>
        <td>Steuerelement</td>
        <td><p>Kann entweder das ClassNN (Klassenname und Instanznummer des Steuerelements) oder der Text des Steuerelements sein, das beides mit Windows Spy ermittelt werden kann. Verwendet man Text, ist das Übereinstimmungsverhalten abhängig von <a href="SetTitleMatchMode.htm">SetTitleMatchMode</a>. Wenn dieser Parameter leer ist, wird das oberste Steuerelement des Fensters benutzt.</p>
          <p>Um ein Steuerelement per HWND (Windows Handle) anzusteuern, muss dieser Parameter leer gelassen und <code>ahk_id %SteuerelementHwnd%</code> im <em>Fenstertitel</em>-Parameter angegeben werden (funktioniert auch bei versteckten Steuerelementen, selbst wenn <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a> deaktiviert ist). Das HWND eines Steuerelements wird üblicherweise per <a href="ControlGet.htm#Hwnd">ControlGet Hwnd</a>, <a href="MouseGetPos.htm">MouseGetPos</a> oder <a href="DllCall.htm">DllCall</a> abgerufen.</p></td>
      </tr>
      <tr>
        <td>Fenstertitel</td>
        <td>Ein Fenstertitel oder sonstige Kriterien, die das Zielfenster ermitteln sollen. Siehe <a href="../misc/WinTitle.htm">Fenstertitel</a>.</td>
      </tr>
      <tr>
        <td>Fenstertext</td>
        <td>In diesem Parameter kann ein Teilstring angegeben werden, der in einem Textelement des Zielfensters vorkommt (werden mit Windows Spy angezeigt). Versteckte Textelemente werden auch erkannt, sofern <a href="DetectHiddenText.htm">DetectHiddenText</a> aktiv ist.</td>
      </tr>
      <tr>
        <td>Titelausnahme</td>
        <td>Ignoriert Fenster, deren Titel diesen Wert enthalten.</td>
      </tr>
      <tr>
        <td>Textausnahme</td>
        <td>Ignoriert Fenster, deren Textelemente diesen Wert enthalten.</td>
      </tr>
    </table>
    <h3>Bemerkungen</h3>
    <p>Wenn keine passenden Fenster oder Steuerelemente gefunden werden, wird jede Ausgabevariable leer gemacht.</p>
    <p>Im Gegensatz zu Befehlen, die ein Steuerelement ändern, hat ControlGetPos keine automatische Verzögerung (d. h. ControlGetPos wird nicht von <a href="SetControlDelay.htm">SetControlDelay</a> beeinflusst).</p>
    <p>Mit <a href="MouseGetPos.htm">MouseGetPos</a> kann das ClassNN oder HWND vom Steuerelement erfasst werden, das sich gerade eben unter dem Mauszeiger befindet. Mit  <a href="WinGet.htm">WinGet ControlList</a> kann eine Liste mit Steuerelementen von einem Fenster abgerufen werden.</p>
    <p>Fenstertitel und -texte unterscheiden zwischen Groß- und Kleinschreibung. Solange <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a> deaktiviert ist, werden versteckte Fenster nicht wahrgenommen.</p>
    <h3>Verwandte Befehle</h3>
    <p><a href="ControlMove.htm">ControlMove</a>, <a href="WinGetPos.htm">WinGetPos</a>, <a href="Control.htm">Control</a>, <a href="ControlGet.htm">ControlGet</a>, <a href="ControlGetText.htm">ControlGetText</a>, <a href="ControlSetText.htm">ControlSetText</a>, <a href="ControlClick.htm">ControlClick</a>, <a href="ControlFocus.htm">ControlFocus</a>, <a href="ControlSend.htm">ControlSend</a></p>
    <h3>Beispiel</h3>
    <pre class="NoIndent"><em>; Dieses Beispiel aktualisiert sich laufend und zeigt Name und Position
; des Steuerelements an, welches sich gerade unter dem Mauszeiger befindet:</em>
Loop
{
    Sleep, 100
    MouseGetPos, , , BestimmtesFenster, BestimmtesSteuerelement
    ControlGetPos, x, y, w, h, %BestimmtesSteuerelement%, ahk_id %BestimmtesFenster%
    ToolTip, %BestimmtesSteuerelement%`nX%X%`tY%Y%`nW%W%`t%H%
}</pre>
  </article>
  </section>
</div>
<script type="text/javascript">WriteFooter(1);</script>
</body>
</html>