<!DOCTYPE HTML>
<html lang="de">
<head>
<title>WinGet - Syntax &amp; Verwendung | AutoHotkey</title>
<meta name="description" content="Der WinGet-Befehl ermittelt die eindeutige ID, Prozess-ID oder den Prozessnamen eines bestimmten Fensters, oder eine Liste aller darin enthaltenen Steuerelemente." />
<meta name="ahk:equiv-v2" content="commands/Win.htm" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
<script src="../static/ga.js" type="text/javascript"></script>
</head>
<body>

<h1>WinGet</h1>

<p>Ermittelt die eindeutige ID, Prozess-ID oder den Prozessnamen eines bestimmten Fensters, oder eine Liste aller darin enthaltenen Steuerelemente. Zudem kann dieser Befehl eine Liste aller Fenster abrufen, die bestimmte Kriterien erfüllen.</p>
<pre class="Syntax"><span class="func">WinGet</span>, AusgabeVar <span class="optional">, <a href="#SubCommands">Unterbefehl</a>, Fenstertitel, Fenstertext, Titelausnahme, Textausnahme</span></pre>

<h2>Parameter</h2>
<dl>
  <dt>AusgabeVar</dt>
  <dd>Name der Variable, in der das Ergebnis von <em>Unterbefehl</em> gespeichert werden soll.</dd>

  <dt>Unterbefehl</dt>
  <dd>Die Operation, die durchgeführt werden soll. Wenn dieser Parameter leer ist, wird standardmäßig der <a href="#ID">ID</a>-Unterbefehl verwendet. Siehe <a href="#SubCommands">Unterbefehle</a>.
</dd>

  <dt>Fenstertitel</dt>
  <dd>Der Titel oder andere Möglichkeiten zum Identifizieren des Zielfensters. Weitere Informationen finden Sie unter <a href="../misc/WinTitle.htm">Fenstertitel-Parameter</a>.</dd>

  <dt>Fenstertext</dt>
  <dd>Eine Zeichenkette, die in einem der Textelemente des Zielfensters enthalten ist (eventuell vorhandene Textelemente können mit dem internen Tool Window Spy aufgedeckt werden). Versteckte Textelemente werden nur erkannt, wenn <a href="DetectHiddenText.htm">DetectHiddenText</a> eingeschaltet ist.</dd>

  <dt>Titelausnahme</dt>
  <dd>Alle Fenster, die diesen Wert in ihren Titeln enthalten, werden ignoriert.</dd>

  <dt>Textausnahme</dt>
  <dd>Alle Fenster, die diesen Wert in ihren Textelementen enthalten, werden ignoriert.</dd>
</dl>

<h2 id="SubCommands">Unterbefehle</h2>
<p>Geben Sie für <em>Unterbefehl</em> Folgendes an:</p>
<ul>
    <li><a href="#ID">ID</a>: Ermittelt die eindeutige ID-Nummer eines Fensters.</li>
    <li><a href="#IDLast">IDLast</a>: Ermittelt die eindeutige ID-Nummer des letzten/untersten Fensters, wenn mehr als ein Fenster gefunden wird.</li>
    <li><a href="#PID">PID</a>: Ermittelt die Prozess-ID-Nummer eines Fensters.</li>
    <li><a href="#ProcessName">ProcessName</a>: Ermittelt den Namen des Prozesses, der ein Fenster besitzt.</li>
    <li><a href="#ProcessPath">ProcessPath</a> <span class="ver">[v1.1.01+]</span>: Ermittelt den vollständigen Pfad und Namen des Prozesses, der ein Fenster besitzt.</li>
    <li><a href="#Count">Count</a>: Ermittelt die Anzahl vorhandener Fenster, die mit den Titel/Text-Parametern übereinstimmen.</li>
    <li><a href="#List">List</a>: Ermittelt die eindeutigen ID-Nummern aller vorhandenen Fenster, die mit den Titel/Text-Parametern übereinstimmen.</li>
    <li><a href="#MinMax">MinMax</a>: Ermittelt den minimierten/maximierten Zustand eines Fensters.</li>
    <li><a href="#ControlList">ControlList</a>: Ermittelt die Namen aller Steuerelemente in einem Fenster.</li>
    <li><a href="#ControlListHwnd">ControlListHwnd</a> <span class="ver">[v1.0.43.06+]</span>: Ermittelt die eindeutigen ID-Nummern aller Steuerelemente in einem Fenster.</li>
    <li><a href="#Transparent">Transparent</a>: Ermittelt die Transparenzstärke eines Fensters.</li>
    <li><a href="#TransColor">TransColor</a>: Ermittelt die Farbe, die in einem Fenster als transparent markiert ist.</li>
    <li><a href="#Style">Style</a>: Ermittelt eine 8-stellige Hexadezimalzahl, die den Style eines Fensters repräsentiert.</li>
    <li><a href="#ExStyle">ExStyle</a>: Ermittelt eine 8-stellige Hexadezimalzahl, die den erweiterten Style eines Fensters repräsentiert.</li>
</ul>

<h3 id="ID">ID</h3>
<p>Ermittelt die eindeutige ID-Nummer eines Fensters.</p>
<pre class="Syntax"><span class="func">WinGet</span>, AusgabeVar, ID <span class="optional">, Fenstertitel, Fenstertext, Titelausnahme, Textausnahme</span></pre>
<p>Auch bekannt als <a href="ControlGet.htm#Hwnd">Window Handle (HWND)</a>. Werden keine passenden Fenster gefunden, wird <em>AusgabeVar</em> leer gemacht. Die Funktionen <a href="WinExist.htm">WinExist()</a> und <a href="WinActive.htm">WinActive()</a> können auch verwendet werden, um die ID eines Fensters zu ermitteln; zum Beispiel wäre <code>WinExist("A")</code> ein schneller Weg, die ID des aktiven Fensters abzurufen. Um die HWND-Nummer eines Steuerelements abzurufen (z. B. für <a href="PostMessage.htm">Post/SendMessage</a> oder <a href="DllCall.htm">DllCall</a>), können Sie <a href="ControlGet.htm#Hwnd">ControlGet Hwnd</a> oder <a href="MouseGetPos.htm">MouseGetPos</a> nutzen.</p>

<h3 id="IDLast">IDLast</h3>
<p>Ermittelt die eindeutige ID-Nummer des letzten/untersten Fensters, wenn mehr als ein Fenster gefunden wird.</p>
<pre class="Syntax"><span class="func">WinGet</span>, AusgabeVar, IDLast <span class="optional">, Fenstertitel, Fenstertext, Titelausnahme, Textausnahme</span></pre>
<p>Auch bekannt als <a href="ControlGet.htm#Hwnd">Window Handle (HWND)</a>. Wenn nur eine Übereinstimmung vorhanden ist, verhält sich dieser Unterbefehl wie der <a href="#ID">ID</a>- Unterbefehl. Dieses Konzept ist vergleichbar mit dem, das von <a href="WinActivateBottom.htm">WinActivateBottom</a> verwendet wird.</p>

<h3 id="PID">PID</h3>
<p>Ermittelt die <a href="Process.htm">Prozess-ID-Nummer</a> eines Fensters.</p>
<pre class="Syntax"><span class="func">WinGet</span>, AusgabeVar, PID <span class="optional">, Fenstertitel, Fenstertext, Titelausnahme, Textausnahme</span></pre>

<h3 id="ProcessName">ProcessName</h3>
<p>Ermittelt den Namen des Prozesses, der ein Fenster besitzt.</p>
<pre class="Syntax"><span class="func">WinGet</span>, AusgabeVar, ProcessName <span class="optional">, Fenstertitel, Fenstertext, Titelausnahme, Textausnahme</span></pre>
<p>Zum Beispiel wäre das "notepad.exe". Wenn keine passenden Fenster gefunden werden, wird <em>AusgabeVar</em> leer gemacht.</p>

<h3 id="ProcessPath">ProcessPath <span class="ver">[v1.1.01+]</span></h3>
<p>Ermittelt den vollständigen Pfad und Namen des Prozesses, der ein Fenster besitzt.</p>
<pre class="Syntax"><span class="func">WinGet</span>, AusgabeVar, ProcessPath <span class="optional">, Fenstertitel, Fenstertext, Titelausnahme, Textausnahme</span></pre>
<p>Zum Beispiel wäre das "C:\Windows\System32\notepad.exe". Wenn keine passenden Fenster gefunden werden, wird <em>AusgabeVar</em> leer gemacht.</p>

<h3 id="Count">Count</h3>
<p>Ermittelt die Anzahl vorhandener Fenster, die mit den Titel/Text-Parametern übereinstimmen.</p>
<pre class="Syntax"><span class="func">WinGet</span>, AusgabeVar, Count <span class="optional">, Fenstertitel, Fenstertext, Titelausnahme, Textausnahme</span></pre>
<p>Wenn keine passenden Fenster gefunden werden, wird <em>AusgabeVar</em> auf 0 gesetzt. Um die Anzahl aller Fenster im Betriebssystem zu ermitteln, lässt man alle vier Titel-/Text-Parameter weg. Versteckte Fenster werden nur mitgezählt, wenn <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a> eingeschaltet ist.</p>

<h3 id="List">List</h3>
<p>Ermittelt die eindeutigen ID-Nummern aller vorhandenen Fenster, die mit den Titel/Text-Parametern übereinstimmen.</p>
<pre class="Syntax"><span class="func">WinGet</span>, AusgabeVar, List <span class="optional">, Fenstertitel, Fenstertext, Titelausnahme, Textausnahme</span></pre>
<p>Um alle Fenster des gesamten Systems abzurufen, lässt man alle vier Titel-/Text-Parameter weg. Jede ID-Nummer wird in eine Variable gespeichert, deren Name mit <em>AusgabeVar</em>'s eigenem Namen beginnt (um einen <a href="../misc/Arrays.htm#pseudo">Pseudo-Array</a> zu formen). <em>AusgabeVar</em> selbst wird auf die Anzahl der abgerufenen Elemente gesetzt (0, wenn keine gefunden werden). Wenn <em>AusgabeVar</em> beispielsweise MeinArray wäre und gäbe es zwei übereinstimmende Fenster, würde MeinArray1 auf die ID des ersten Fensters, MeinArray2 auf die ID des zweiten Fensters und MeinArray selbst auf 2 gesetzt werden. Die Fenster werden von oben nach unten abgerufen (entsprechend der Tatsache, wie sie auf dem Desktop gestapelt sind). Versteckte Fenster werden nur mitgezählt, wenn <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a> eingeschaltet ist. Um innerhalb einer <a href="../Functions.htm">Funktion</a> ein Pseudo-Array global statt lokal zu machen, <a href="../Functions.htm#Global">deklariert</a> man MeinArray als globale Variable, bevor man diesen Befehl verwendet (das Gegenteil davon gilt für <a href="../Functions.htm#AssumeGlobal">Assume-Global</a>-Funktionen). Oft ist es auch notwendig, jede Variable in diesem Satz einzeln zu deklarieren, da ein <a href="../Functions.htm#ArrayConfusion">häufiger Anlass zu Verwirrung</a> vorliegt.</p>

<h3 id="MinMax">MinMax</h3>
<p>Ermittelt den minimierten/maximierten Zustand eines Fensters.</p>
<pre class="Syntax"><span class="func">WinGet</span>, AusgabeVar, MinMax <span class="optional">, Fenstertitel, Fenstertext, Titelausnahme, Textausnahme</span></pre>
<p><em>AusgabeVar</em> wird leer gemacht, wenn keine passenden Fenster gefunden werden, ansonsten ist eine der folgenden Zahlen enthalten:</p>
<ul>
  <li>-1: Das Fenster ist minimiert (<a href="WinRestore.htm">WinRestore</a> kann die Minimierung aufheben).</li>
  <li>1: Das Fenster ist maximiert (<a href="WinRestore.htm">WinRestore</a> kann die Maximierung aufheben).</li>
  <li>0: Das Fenster ist weder minimiert noch maximiert.</li>
</ul>

<h3 id="ControlList">ControlList</h3>
<p>Ermittelt die Namen aller Steuerelemente in einem Fenster.</p>
<pre class="Syntax"><span class="func">WinGet</span>, AusgabeVar, ControlList <span class="optional">, Fenstertitel, Fenstertext, Titelausnahme, Textausnahme</span></pre>
<p>Falls keine passenden Fenster gefunden werden oder keine Steuerelemente im Fenster vorhanden sind, wird <em>AusgabeVar</em> leer gemacht. Ansonsten wird eine Liste zurückgegeben, die die ClassNN-Bezeichnung von jedem Steuerelement enthält (ClassNN ist der Klassenname des Steuerelements, gefolgt der Reihenfolgenummer innerhalb des übergeordneten Fensters, wie im internen Tool Window Spy angezeigt).</p>
<p>Jedes Element, außer das letzte, endet mit einem LF-Zeichen (`n). <a href="#ExControlList">Beispiel #3</a> im letzten Abschnitt zeigt, wie eine <a href="LoopParse.htm">Parsende Schleife</a> genutzt werden kann, um die Steuerelementnamen einzeln durchzugehen.</p>
<p>Steuerelemente werden nach ihrer Z-Reihenfolge sortiert, das üblicherweise der Navigation mit der <kbd>Tab</kbd>-Taste entspricht, sofern vom Fenster unterstützt.</p>

<h3 id="ControlListHwnd">ControlListHwnd <span class="ver">[v1.0.43.06+]</span></h3>
<p>Ermittelt die eindeutigen ID-Nummern aller Steuerelemente in einem Fenster.</p>
<pre class="Syntax"><span class="func">WinGet</span>, AusgabeVar, ControlListHwnd <span class="optional">, Fenstertitel, Fenstertext, Titelausnahme, Textausnahme</span></pre>
<p>Falls keine passenden Fenster gefunden werden oder keine Steuerelemente im Fenster vorhanden sind, wird <em>AusgabeVar</em> leer gemacht. Ansonsten ist jede eindeutige ID das <a href="ControlGet.htm#Hwnd">HWND-Nummer</a> des Steuerelements. Jedes Element, außer das letzte, endet mit einem LF-Zeichen (`n).</p>
<p>Steuerelemente werden nach ihrer Z-Reihenfolge sortiert, das üblicherweise der Navigation mit der <kbd>Tab</kbd>-Taste entspricht, sofern vom Fenster unterstützt.</p>

<h3 id="Transparent">Transparent</h3>
<p>Ermittelt die Transparenzstärke eines Fensters.</p>
<pre class="Syntax"><span class="func">WinGet</span>, AusgabeVar, Transparent <span class="optional">, Fenstertitel, Fenstertext, Titelausnahme, Textausnahme</span></pre>
<p>Mit <a href="WinSet.htm">WinSet</a> kann ein Fenster transparent gemacht werden. <em>AusgabeVar</em> wird leer gemacht, wenn: 1) das Betriebssystem älter als Windows XP ist; 2) keine passenden Fenster gefunden werden; 3) das Fenster nicht transparent ist; oder 4) andere Bedingungen auftreten (durch das Verhalten des Betriebssystems), z. B. wenn das transparent gemachte Fenster minimiert, wiederhergestellt und/oder skaliert wurde. Ansonsten wird eine Zahl zwischen 0 und 255 gespeichert - 0 wäre ein durchsichtiges Fenster und 255 ein undurchsichtiges Fenster. Zum Beispiel:</p>
<pre>MouseGetPos,,, MausFenster
WinGet, Transparenz, Transparent, ahk_id %MausFenster%  <em>; Transparenz eines Fensters unterhalb des Mauszeigers.</em></pre>

<h3 id="TransColor">TransColor</h3>
<p>Ermittelt die Farbe, die in einem Fenster als transparent markiert ist.</p>
<pre class="Syntax"><span class="func">WinGet</span>, AusgabeVar, TransColor <span class="optional">, Fenstertitel, Fenstertext, Titelausnahme, Textausnahme</span></pre>
<p>Mit <a href="WinSet.htm#TransColor">WinSet</a> kann eine Farbe als transparent markiert werden. <em>AusgabeVar</em> wird leer gemacht, wenn: 1) das Betriebssystem älter als Windows XP ist; 2) keine passenden Fenster gefunden werden; 3) das Fenster keine transparente Farbe hat; oder 4) andere Bedingungen auftreten (durch das Verhalten des Betriebssystems), z. B. wenn das transparent gemachte Fenster minimiert, wiederhergestellt und/oder skaliert wurde. Ansonsten wird eine 6-stellige hexadezimale RGB-Farbe gespeichert (z. B. 0x00CC99). Zum Beispiel:</p>
<pre>MouseGetPos,,, MausFenster
WinGet, TransFarbe, TransColor, ahk_id %MausFenster%  <em>; Transparente Farbe eines Fensters unterhalb des Mauszeigers.</em></pre>

<h3 id="Style">Style</h3>
<p>Ermittelt eine 8-stellige Hexadezimalzahl, die den Style eines Fensters repräsentiert.</p>
<pre class="Syntax"><span class="func">WinGet</span>, AusgabeVar, Style <span class="optional">, Fenstertitel, Fenstertext, Titelausnahme, Textausnahme</span></pre>
<p>Wenn keine passenden Fenster gefunden werden, wird <em>AusgabeVar</em> leer gemacht. Das folgende Beispiel stellt fest, ob ein Fenster den WS_DISABLED-Style hat:</p>
<pre>WinGet, Style, Style, Mein Fenstertitel
if (Style &amp; 0x8000000)  <em>; 0x8000000 ist WS_DISABLED.</em>
  MsgBox Das Fenster ist deaktiviert.</pre>
<p>Die <a href="../misc/Styles.htm">Style-Tabelle</a> beinhaltet eine Auflistung einiger Styles.</p>

<h3 id="ExStyle">ExStyle</h3>
<p>Ermittelt eine 8-stellige Hexadezimalzahl, die den erweiterten Style eines Fensters repräsentiert.</p>
<pre class="Syntax"><span class="func">WinGet</span>, AusgabeVar, ExStyle <span class="optional">, Fenstertitel, Fenstertext, Titelausnahme, Textausnahme</span></pre>
<p>Wenn keine passenden Fenster gefunden werden, wird <em>AusgabeVar</em> leer gemacht. Das folgende Beispiel stellt fest, ob ein Fenster den WS_EX_TOPMOST-Style hat (immer im Vordergrund):</p>
<pre>WinGet, ExStyle, ExStyle, Mein Fenstertitel
if (ExStyle &amp; 0x8)  <em>; 0x8 ist WS_EX_TOPMOST.</em>
   MsgBox Das Fenster ist immer im Vordergrund.</pre>
<p>Die <a href="../misc/Styles.htm">Style-Tabelle</a> beinhaltet eine Auflistung einiger Styles.</p>

<h2>Bemerkungen</h2>
<p>Die ID-Nummer eines Fensters ist nur gültig, während es existiert. Wenn man also eine Anwendung neustarten würde, bekämen all ihre Fenster neue ID-Nummern.</p>
<p>Alle ID-Nummern, die von diesem Befehl abgerufen werden, sind numerisch (ohne den Präfix "ahk_id") und werden im hexadezimalen Format gespeichert, egal welche <a href="SetFormat.htm">SetFormat</a>-Einstellung gerade aktiv ist.</p>
<p>Die ID des Fensters, das sich unter dem Mauszeiger befindet, kann mit <a href="MouseGetPos.htm">MouseGetPos</a> abgerufen werden.</p>
<p>Zwar sind die ID-Nummern zurzeit vorzeichenlose 32-Bit-Integer, allerdings könnten sie in einer zukünftigen Version zu 64-Bit-Integer werden. Demzufolge sollte man numerische Operationen wie Addition bei solchen Werten vermeiden, weil solche Operationen ihre eingehenden Zeichenketten als vorzeichenfähige statt vorzeichenlose Integer voraussetzen.</p>
<p>Fenstertitel und -texte sind Groß-/Kleinschreibung-sensitiv. Versteckte Fenster werden nur erkannt, wenn <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a> eingeschaltet ist.</p>

<h2>Siehe auch</h2>
<p><a href="WinGetClass.htm">WinGetClass</a>, <a href="Process.htm">Process</a>, <a href="WinGetTitle.htm">WinGetTitle</a>, <a href="MouseGetPos.htm">MouseGetPos</a>, <a href="ControlGet.htm">ControlGet</a>, <a href="ControlFocus.htm">ControlFocus</a>, <a href="GroupAdd.htm">GroupAdd</a></p>

<h2>Beispiele</h2>

<div class="ex" id="ExID">
<p><a href="#ExID">#1</a>: Maximiert das aktive Fenster und meldet dessen eindeutige ID:</p>
<pre>WinGet, AktiveID, ID, A
WinMaximize, ahk_id %AktivID%
MsgBox, Die ID des aktiven Fensters ist "%AktiveID%".</pre>
</div>

<div class="ex" id="ExList">
<p><a href="#ExList">#2</a>: Besucht alle Fenster des gesamten Systems und zeigt Informationen zu jedem Fenster an:</p>
<pre>WinGet, id, List,,, Program Manager
Loop, %id%
{
    diese_ID := id%A_Index%
    WinActivate, ahk_id %diese_ID%
    WinGetClass, diese_Klasse, ahk_id %diese_ID%
    WinGetTitle, dieser_Titel, ahk_id %diese_ID%
    MsgBox, 4, , Gehe alle Fenster durch`n%A_Index% von %id%`nahk_id %diese_ID%`nahk_class %diese_Klasse%`n%dieser_Titel%`n`nWeiter?
    IfMsgBox, NO, break
}</pre>
</div>

<div class="ex" id="ExControlList">
<p><a href="#ExControlList">#3</a>: Extrahiert die einzelnen Steuerelementnamen aus der Steuerelementliste des aktiven Fensters:</p>
<pre>WinGet, Steuerelementliste, ControlList, A
Loop, Parse, Steuerelementliste, `n
{
    MsgBox, 4,, Steuerelement #%A_Index% ist "%A_LoopField%". Weiter?
    IfMsgBox, No
        break
}</pre>
</div>

<div class="ex" id="ExRealTime">
<p><a href="#ExRealTime">#4</a>: Zeigt in Echtzeit die Steuerelementliste des aktiven Fensters an:</p>
<pre>#Persistent
SetTimer, AktivesFensterBeobachten, 200
return

AktivesFensterBeobachten:
WinGet, Steuerelementliste, ControlList, A
ToolTip, %Steuerelementliste%
return</pre>
</div>

</body>
</html>
