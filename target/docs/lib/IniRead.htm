<!DOCTYPE HTML>
<html lang="de">
<head>
<title>IniRead - Syntax &amp; Verwendung | AutoHotkey v1</title>
<meta name="description" content="Der IniRead-Befehl liest einen Wert, eine Sektion oder eine Liste von Sektionsnamen aus einer INI-Datei im Standardformat." />
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
<script src="../static/ga4.js" type="text/javascript"></script>
</head>
<body>

<h1>IniRead</h1>

<p>Liest einen Wert, eine Sektion oder eine Liste von Sektionsnamen aus einer INI-Datei im Standardformat.</p>

<pre class="Syntax">
<span class="func">IniRead</span>, AusgabeVar, DateiName, Sektion, Schlüssel <span class="optional">, Standardwert</span>
<span class="func">IniRead</span>, AusgabeVarSektion, DateiName, Sektion
<span class="func">IniRead</span>, AusgabeVarSektionNamen, DateiName
</pre>
<h2 id="Parameters">Parameter</h2>
<dl>

  <dt>AusgabeVar</dt>
  <dd>
      <p>Name der Ausgabevariable, in der der abgerufene Wert gespeichert werden soll. Wenn der Wert nicht abgerufen werden kann, wird die Variable auf den <em>Standardwert</em> gesetzt (siehe unten).</p>
    </dd>
  
  <dt>AusgabeVarSektion</dt>
  <dd><p><span class="ver">[AHK_L 57+]</span>: Lassen Sie den <em>Schlüssel</em>-Parameter weg, um die gesamte Sektion zu lesen. Kommentare und Leerzeilen werden weggelassen. Es werden nur die ersten 65533 Zeichen der Sektion abgerufen.</p></dd>
  
  <dt>AusgabeVarSektionNamen</dt>
  <dd><p><span class="ver">[AHK_L 57+]</span>: Lassen Sie den <em>Schlüssel</em>- und <em>Sektion</em>-Parameter weg, um eine Liste von Sektionsnamen abzurufen, die alle mit einem Zeilenvorschub (<code class="no-highlight">`n</code>) voneinander getrennt sind.</p></dd>

  <dt>DateiName</dt>
  <dd><p>Name der INI-Datei. Wenn kein absoluter Pfad angegeben ist, wird die Datei im <a href="../Variables.htm#WorkingDir">A_WorkingDir</a>-Verzeichnis vermutet.</p></dd>

  <dt>Sektion</dt>
  <dd><p>Name einer Sektion in der INI-Datei, erkennbar an den eckigen Klammern (die Klammern müssen in diesem Parameter weggelassen werden).</p></dd>

  <dt>Schlüssel</dt>
  <dd><p>Name eines Schlüssels in der INI-Datei.</p></dd>

  <dt>Standardwert</dt>
  <dd><p>Wenn leer oder weggelassen, wird standardmäßig das Wort ERROR verwendet. Andernfalls geben Sie den Wert an, der in <em>AusgabeVar</em> gespeichert werden soll, wenn der gesuchte Schlüssel nicht gefunden wird. Um einen leeren Wert (leere Zeichenkette) als Standardwert zu definieren, geben Sie <a href="../Variables.htm#Space">%A_Space%</a> an.</p>
      <p><span class="ver">[AHK_L 57+]</span>: Dieser Parameter ist wirkungslos, wenn der <i>Schlüssel</i>-Parameter weggelassen wird.</p>
      </dd>

</dl>
<h2 id="Error_Handling">Fehlerbehandlung</h2>
<p><a href="../misc/ErrorLevel.htm">ErrorLevel</a> wird <u>nicht</u> durch diesen Befehl geändert. Wenn ein Problem aufgetreten ist, wird <em>AusgabeVar</em> auf den Standardwert gesetzt, wie oben beschrieben.</p>
<h2 id="Remarks">Bemerkungen</h2>
<p>Das Betriebssystem entfernt automatisch Leer- und Tabulatorzeichen am Anfang und Ende der abgerufenen Zeichenkette. Um das zu verhindern, umschließen Sie die Zeichenkette mit einfachen oder doppelten Anführungszeichen. Das äußerste Paar von einfachen oder doppelten Anführungszeichen wird ebenfalls entfernt, aber Leerzeichen innerhalb der Anführungszeichen bleiben erhalten.</p>
<p>Werte länger als 65535 Zeichen führen wahrscheinlich zu inkonsistenten Ergebnissen.</p>
<p>Eine typische INI-Datei sieht wie folgt aus:</p>
<pre class="no-highlight">[SektionName]
Schlüssel=Wert</pre>
<p><b>Unicode:</b> IniRead und IniWrite verwenden die externen Funktionen <a href="https://learn.microsoft.com/windows/win32/api/winbase/nf-winbase-getprivateprofilestring">GetPrivateProfileString</a> und <a href="https://learn.microsoft.com/windows/win32/api/winbase/nf-winbase-writeprivateprofilestringa">WritePrivateProfileString</a>, um Werte zu lesen oder zu schreiben. Diese Funktionen unterstützen Unicode nur in UTF-16-Dateien; alle anderen Dateien verwenden die Standard-ANSI-Codepage des Systems.</p>
<h2 id="Related">Siehe auch</h2>
<p><a href="IniDelete.htm">IniDelete</a>, <a href="IniWrite.htm">IniWrite</a>, <a href="RegRead.htm">RegRead</a>, <a href="LoopReadFile.htm">dateilesende Schleife</a>, <a href="FileRead.htm">FileRead</a></p>
<h2 id="Examples">Beispiele</h2>
<div class="ex" id="ExBasic">
<p><a class="ex_number" href="#ExBasic"></a> Liest den Wert eines Schlüssels in Sektion2 aus einer INI-Datei im Standardformat und speichert ihn in <var>AusgabeVar</var>.</p>
<pre>IniRead, AusgabeVar, C:\Temp\MeineDatei.ini, Sektion2, Schlüssel
MsgBox, Der Wert ist %AusgabeVar%.</pre>
</div>

</body>
</html>
